let o=null,e=null;function s(){document.addEventListener("focusin",c),chrome.runtime.onMessage.addListener((t,n,u)=>{t.type==="GET_SELECTED_TEXT"&&r()}),console.log("PromptPilot content script initialized")}function c(t){const n=t.target;n.tagName==="TEXTAREA"||n.getAttribute("contenteditable")==="true"?(o=n,d(n)):(i(),o=null)}function d(t){i(),e=document.createElement("button"),e.textContent="✏️ Improve",e.style.position="absolute",e.style.zIndex="10000",e.style.padding="4px 8px",e.style.backgroundColor="#4285f4",e.style.color="white",e.style.border="none",e.style.borderRadius="4px",e.style.fontSize="12px",e.style.cursor="pointer",e.style.boxShadow="0 1px 3px rgba(0, 0, 0, 0.3)";const n=t.getBoundingClientRect();e.style.top=`${window.scrollY+n.top-30}px`,e.style.left=`${window.scrollX+n.right-100}px`,e.addEventListener("click",l),document.body.appendChild(e)}function i(){e&&e.parentNode&&(e.removeEventListener("click",l),e.parentNode.removeChild(e),e=null)}function l(){o&&(r(),chrome.runtime.sendMessage({type:"OPEN_POPUP"}))}function r(){if(o){let t="";o.tagName==="TEXTAREA"?t=o.value:o.getAttribute("contenteditable")==="true"&&(t=o.innerText),chrome.runtime.sendMessage({type:"CAPTURED_TEXT",text:t})}}s();
